name: Quality pipeline

on: [push]

jobs:
  ensure-code-quality:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Install NodeJS 14
        uses: actions/setup-node@v2
        with:
          node-version: 14

      - name: Install
        run: npm Install

      - name: Lint
        run: npm run lint

  verify-sqlserver-setup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Setup SQLServer
        uses: ./
        env:
          ACCEPT_EULA: 'Y'
        with:
          image: 'mcr.microsoft.com/mssql/server:2019-latest'
          port: 1433
          username: sa
          password: Pa$$w0rd
          database: testdb

      - name: Test setup
        run: echo "TBD"

  verify-postgresql-setup:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v2

      - name: Setup PostgreSQL
        uses: ./
        with:
          image: 'postgres:alpine'
          port: 5432
          username: postgres
          password: postgres
          database: testdb

      - name: Test setup
        run: echo "TBD"